-- Backport and Internal patches --

OOZIE-3156 Retry SSH action check when cannot connect to remote host
OOZIE-2427 [Kerberos] Authentication failure for the javascript resources under /ext-2.2 (lianggz via andras.piros)
BUG-107508 OOZIE-2488 Upgrade to latest OpenJPA version (abhishekbafna via jaydeepvishwakarma)
BUG-99803 Oozie should disable HBase dynamic class loading - amendum for BUG-96737
BUG-97859 Permission issue- r+x for others under hadoop fs -ls /user/oozie/share/lib/lib_XXXX
BUG-96737 OOZIE-3199 Let system property restriction configurable
BUG-79059 OOZIE-3109 SCA : Cross-Site Scripting: Reflected
BUG-97742 OOZIE-1624 Exclusion pattern for sharelib.
BUG-97674 OOZIE-3186 Oozie is unable to use configuration linked using jceks://file/
BUG-96737 Use java io filesystem methods to access local files
BUG-96984 Unable to find spark yarn jars due to strict regex pattern in sharelib
BUG-96911 OOZIE-2923 Improve Spark options parsing (andras.piros via gezapeti)
BUG-96911 OOZIE-2799 Setting log location for spark sql on hive (satishsaley)
BUG-96911 OOZIE-2792 Hive2 action is not parsing Spark application ID from log file properly when Hive is on Spark (zhengxb2005 via rkanter)
BUG-96911 OOZIE-2571 Add spark.scala.binary.version Maven property so that Scala 2.11 can be used (jonathak via rkanter)
BUG-90041 SCA : JavaScript Hijacking
BUG-96926 Backport OOZIE-3167: Upgrade tomcat version on Oozie 4.3 branch
BUG-94744 OOZIE-2802 Spark action failure on Spark 2.1.0 due to duplicate sharelibs (gezapeti via rkanter)
BUG-94744 OOZIE-2658 --driver-class-path can overwrite the classpath in SparkMain (gezapeti via rkanter)
BUG-94744 OOZIE-2787 Oozie distributes application jar twice making the spark job fail (satishsaley)
BUG-94744 OOZIE-2606 Set spark.yarn.jars to fix Spark 2.0 with Oozie (satishsaley via rohini)
BUG-94900 Set spark.yarn.jars to fix Spark 2.0 with Oozie
BUG-95593 Extend Oozie DB utils to support Spark2 sharelib creation
BUG-93159 BUG-92477 OOZIE-3139 Oozie validates workflow incorrectly (dionusos via pbacsko)
BUG-92987 OOZIE-2720 Test failure - TestCoordMaterializeTriggerService#testMaxMatThrottleNotPicked (gezapeti via rohini)
BUG-92179 OOZIE-3018 Use Hadoop's CredentialProvider for passwords in SchemaCheckerService (andras.piros via gezapeti)
BUG-90267: Addendum patch
BUG-90400 Backport OOZIE-2908: Fix typo in oozie.actions.null.args.allowed property in oozie-default.xml
BUG-89505 Backport OOZIE-2872: Address backward compatibility issue introduced by OOZIE-2748 (pbacsko)
BUG-90267: Refactor jdk.tools and c3p0 dependencies
BUG-83293: Oozie fails to submit job with validation error.
BUG-89103: Backport OOZIE-2440 Exponential re-try policy for workflow action
BUG-88432 OOZIE-2608: Comma in oozie.service.JPAService.jdbc.password value results in authentication error
BUG-87155 OOZIE-2615 Flaky tests TestCoordActionsKillXCommand.testActionKillCommandActionNumbers and testActionKillCommandDate (pbacsko via rkanter)
BUG-82808 OOZIE-2928 Unit Tests using LocalOozie fail randomly (Denes Bodo via pbacsko)
BUG-80809 Backport OOZIE-2781 HCat partition available notification is not sent to coordinator actions if coordinator job is using a different hostname (cname, IP address, etc. ) for HCat URL
BUG-80811 Backport OOZIE-2807 Oozie gets RM delegation token even for checking job status (satishsaley)
BUG-85803 OOZIE-2588 Support getting credentials for same cluster hcat when credentials config is empty (satishsaley via rohini)
BUG-85803 Backport OOZIE-2819: Make Oozie REST API accept multibyte characters for script Actions (asasvari via rkanter)
BUG-85738 Backport OOZIE-2656: OozieShareLibCLI uses op system username instead of Kerberos to upload jars
BUG-80808 Backport OOZIE-2777: Config-default.xml longer than 64k results in java.io.UTFDataFormatException (gezapeti via harsh)
BUG-80800 Backport OOZIE-2658: --driver-class-path can overwrite the classpath in SparkMain (gezapeti via rkanter)
BUG-80807 Backport OOZIE-2748: NPE in LauncherMapper.printArgs()
BUG-80806 Backport OOZIE-2727: OozieDBCLI creates temporary directories and do not delete them
BUG-80805 Backport OOZIE-2724: coord:current resolves monthly/yearly dependencies incorrectly
BUG-80802 Backport OOZIE-2672: SLA periodic update does not remove job from map if job is removed from database
BUG-80801 Backport OOZIE-2661: Coordinator Action status not updated when workflow job SUSPENDED
BUG-80799 Backport OOZIE-2653: Close active connection to hcat server in fs action
BUG-80798 Backport OOZIE-2623: Oozie should use a dummy OutputFormat
BUG-80797 Backport OOZIE-2589: CompletedActionXCommand is hardcoded to wrong priority
BUG-80810 Backport OOZIE-2803: Mask passwords when printing out configs/args in MapReduceMain and SparkMain
BUG-80344 Backport OOZIE-2581: Oozie should reset SecurityManager in finally block
BUG-80340 Tomcat needs to be upgraded in Oozie to 6.0.48
BUG-80343 Backport OOZIE-2572: SLA DURATION miss not shown when job is running for longer than expected time
BUG-80342 Backport OOZIE-2552: Update ActiveMQ version for security and other fixes
BUG-80341 Backport OOZIE-2539: Incorrect property key is used for 'hive log4j configuration file for execution mode'
BUG-80250 Backport OOZIE-2501: ZK reentrant lock doesn't work for few cases
BUG-80248 Backport OOZIE-2457: Oozie log parsing regex consume more than 90% cpu OOZIE-2496 Testcase failure due to environment specific line.separator value (abhishekbafna via rkanter)
BUG-80247 Backport OOZIE-2433: oozie restart required if oozie metrics to graphing tool broken
BUG-80246 Backport OOZIE-2037: Add TLSv1.1,TLSv1.2
BUG-80245 Backport OOZIE-1978: Forkjoin validation code is ridiculously slow in some cases Backport OOZIE-2719 Test case failure (abhishekbafna via jaydeepvishwakarma)
BUG-73040 Update datanucleus deps and exclude jackson-annotations from hwx-common for spark UT fix.
BUG-74584 Backport OOZIE-2742 to Fenton.
BUG-74584 Backport OOZIE-2582 to Fenton.
BUG-74584 Backport OOZIE-2678 to Fenton.
BUG-74584 Backport OOZIE-2243 to Fenton.
BUG-73122 Backport OOZIE-2649 to Fenton.
BUG-69923 Back porting OOZIE-1814
BUG-69923 Masking Hive2 JDBC password
BUG-69923 Back porting OOZIE-2244
BUG-69927 Removing getPasswordFromHadoopConf method from HadoopAccessorService
BUG-69922 Remove XLogCopyService and relevant code
BUG-69396 Oozie Spark action ignores spark.executor.extraJavaOptions and spark.driver.extraJavaOptions
BUG-62891 Support for multiple HCat uri into parsing
BUG-69393 upgrading joda-time version
BUG-69659 Flip the null check condition for preventing NPE

-- Oozie patches since Oozie 4.2.0

OOZIE-2723 JSON.org license is now CatX
OOZIE-2436 Fork/join workflow fails with "oozie.action.yarn.tag must not be null" (puru)
OOZIE-2578 Oozie example distcp job fails to run within an encrypted zone with checksum match error (pbacsko via rkanter)
OOZIE-2362 SQL injection in BulkJPAExecutor (pbacsko via rkanter)
OOZIE-2577 Flaky tests TestCoordActionInputCheckXCommand.testTimeout and testTimeoutWithException (pbacsko via rkanter)
OOZIE-2570 remove -PtestPatchCompile from patch testing as there is no such profile (gezapeti via rkanter)
OOZIE-2504 Create a log4j.properties under HADOOP_CONF_DIR in Shell Action (harsh)
OOZIE-2567 HCat connection is not closed while getting hcat cred (puru)
OOZIE-2547 Add mapreduce.job.cache.files to spark action (satishsaley via rohini)
OOZIE-2550 Flaky tests in TestZKUUIDService.java (pbacsko via rkanter)
OOZIE-2445 Doc for - Specifying coordinator input datasets in more logical ways (puru)
OOZIE-2541 Possible resource leak in Hive2Credentials (pbacsko via rkanter)
OOZIE-2563 Pass spark-defaults.conf to spark action (satishsaley via rohini)
OOZIE-2556 TestAbandonedCoordChecker.testCatchupJob is flaky (puru)
OOZIE-2522 There can be multiple coord submit from bundle in case of ZK glitch (puru)
OOZIE-2553 Cred tag is required for all actions in the workflow even if an action does not require it (me.venkatr via rohini)
OOZIE-2503 show ChildJobURLs to spark action (satishsaley via puru)
OOZIE-2551 Feature request: epoch timestamp generation (jtolar via puru)
OOZIE-2542 Option to disable OpenJPA BrokerImpl finalization (puru)
OOZIE-2447 Illegal character 0x0 oozie client (satishsaley via puru)
OOZIE-2548 Flaky test TestZKLocksService.testLockReaper (pbacsko via puru)
OOZIE-2546 Improperly closed resources in OozieDBCLI (pbacsko via rkanter)
OOZIE-2476 When one of the action from fork fails with transient error, WF never joins (puru)
OOZIE-2475 Oozie does not cleanup action dir of killed actions (satishsaley via rohini)
OOZIE-2535 User can't disable uber mode (puru)
OOZIE-2482 Pyspark job fails with Oozie (satishsaley and gezapeti via rkanter)
OOZIE-2467 Oozie can shutdown itself on long GC pause (puru)
OOZIE-2537 SqoopMain does not set up log4j properly (pbacsko via rkanter)
OOZIE-2532 patch apply does not handle binary files (gezapeti via rkanter)
OOZIE-2330 Spark action should take the global jobTracker and nameNode configs by default and allow file and archive elements (satishsaley via rkanter)
OOZIE-2510 TestLogStreamer.testStreamLog() fails in other timezones (pbacsko via rkanter)
OOZIE-2531 Prevent Spark trying for token which is already available (satishsaley via rkanter)
OOZIE-2509 SLA job status can stuck in running state (puru)
OOZIE-2529 Support adding secret keys to Credentials of Launcher (satishsaley via rohini)
OOZIE-1402 Increase retry interval for non-progressing coordinator action with fix value (satishsaley via puru)
OOZIE-2512 ShareLibservice returns incorrect path for jar (satishsaley via puru)
OOZIE-2471 Show child job url tab for distcp (satishsaley via puru)
OOZIE-2511 SubWorkflow missing variable set from option if config-default is present in parent workflow (asasvari via rkanter)
OOZIE-2391 spark-opts value in workflow.xml is not parsed properly (gezapeti via rkanter)
OOZIE-2489 XML parsing is vulnerable (fdenes via rkanter)
OOZIE-2485 Oozie client keeps trying to use expired auth token (rkanter)
OOZIE-2490 Oozie can't set hadoop.security.token.service.use_ip (rkanter)
OOZIE-2474 <job-xml> is not being applied to the launcher job (rkanter)
OOZIE-2486 TestSLAEventsGetForFilterJPAExecutor is flakey (rkanter)
OOZIE-2481 Add YARN_CONF_DIR in the Shell action (harsh)
OOZIE-2492 JSON security issue in js code (fdenes via rkanter)
OOZIE-2429 TestEventGeneration test is flakey (fdenes via rkanter)
OOZIE-2466 Repeated failure of TestMetricsInstrumentation.testSamplers (fdenes via rkanter)
OOZIE-2470 Remove infinite socket timeouts in the Oozie email action (harsh)
OOZIE-2246 CoordinatorInputCheckCommand does not behave properly when har file is one of data dependency and doesn't exist (satishsaley via puru)
OOZIE-2446 Job does not fail during submission if non existent credential is specified (satishsaley via puru)
OOZIE-2283 Documentation should not say that System.exit is not allowed in Java Action (eeeva via rkanter)
OOZIE-2400 Workflow xml configuration parser cannot deal with namespace prefix (lars_francke via rkanter)
OOZIE-2452 Coordinator Functional Specification - EL Constants Typo (markgreene via puru)
OOZIE-2173 DISCLAIMER.txt still refers to Apache Incubator (eeeva via rkanter)
OOZIE-2312 oozie doesn't purge audit and error log (puru)
OOZIE-2431 Support hive.metastore.uris as alias for hcat.metastore.uri (satishsaley via puru)
OOZIE-1976 Specifying coordinator input datasets in more logical ways (puru)
OOZIE-2444 Need conditional logic in bundles (satishsaley via puru)
OOZIE-2394 Oozie can execute command without holding lock (puru)
OOZIE-1922 MemoryLocksService fails if lock is acquired multiple times in same thread and released (puru)
OOZIE-2432 TestPurgeXCommand fails (fdenes via rkanter)
OOZIE-2434 inconsistent coord action status and workflow job status (satishsaley via puru)
OOZIE-2438 Oozie client "jobs -filter" diagnostic message clarification (satishsaley via puru)
OOZIE-2165 Job log fetching can fail in Oozie HA mode when using doAs impersonation (satishsaley via puru)
OOZIE-2430 Add root logger for hive,sqoop action (satishsaley via puru)
OOZIE-2441 SubWorkflow action with propagate-configuration but no global section throws NPE on submit (rkanter)
OOZIE-2370 Docs for Coordinator Action Status Notification has wrong property name (eeeva via rkanter)
OOZIE-2419 HBase credentials are not correctly proxied (qwertymaniac via rkanter)
OOZIE-2439 FS Action no longer uses name-node from global section or default NN (rkanter)
OOZIE-2435 TestCoordChangeXCommand is flakey (fdenes via rkanter)
OOZIE-2428 TestSLAService, TestSLAEventGeneration flakey tests (fdenes via rkanter)
OOZIE-2437 Exclude additional Hadoop dependencies from Spark Sharelib (rkanter)
OOZIE-2030 Configuration properties from global section is not getting set in Hadoop job conf when using sub-workflow action in Oozie workflow.xml (jaydeepvishwakarma via rohini)
OOZIE-2380 Oozie Hive action failed with wrong tmp path (vaifer via rkanter)
OOZIE-2222 Oozie UI parent job should be clickable (puru)
OOZIE-2407 AbandonedService should not send mail if there is no abandoned coord (puru)
OOZIE-2402 oozie-setup.sh sharelib create takes a long time on large clusters (yalovyyi via rkanter)
OOZIE-2185 Make oozie cli source conf/oozie-client-env.sh (grimesmi via rkanter)
OOZIE-2413 Kerberos credentials can expire if the KDC is slow to respond (rkanter)
OOZIE-2411 Add BCC to oozie email action (fdenes via rkanter)
OOZIE-2397 LAST_ONLY and NONE don't properly handle READY actions (rkanter)
OOZIE-2401 Typo in twiki docs with FilesAchives instead of FilesArchives (anthony@cloudera.com via rkanter)
OOZIE-2168 Oozie flow and action names have 50 char limit (akshayrai09, me.venkatr via rkanter)
OOZIE-2346 Add sub-workflow information like the super-parent id and workflow depth into the 'oozie.job.info' property (akshayrai09 via puru)
OOZIE-2303 Typo in documentation (lars_francke via rohini)
OOZIE-2328 Coordinator endtime change should check if the last action is in database (kailongs via puru)
OOZIE-2367 fs delete should support skipTrash option (jaydeepvishwakarma via rohini)
OOZIE-2368 coord:dateOffset and coord:dateTzOffset can't be used for coord initial-instance (puru)
OOZIE-2369 coord:offset doesn't resolve correctly (puru)
OOZIE-2251 Expose instrumental matrices in Realtime Graphing tool (nperiwal via rkanter)
OOZIE-2314 Unable to kill old instance child job by workflow or coord rerun by Launcher (jaydeepvishwakarma via rkanter)
OOZIE-2386 org.apache.oozie.util.TestXConfiguration.testSubstituteVar is flakey (rkanter)
OOZIE-2385 org.apache.oozie.TestCoordinatorEngineStreamLog.testCoordLogStreaming is flakey (rkanter)
OOZIE-2382 org.apache.oozie.action.hadoop.TestPigMain.testPig_withNullExternalID is flakey (rkanter)
OOZIE-2379 org.apache.oozie.command.coord.TestCoordPushDependencyCheckXCommand.testRequeueOnException is flakey (rkanter)
OOZIE-2378 org.apache.oozie.client.TestOozieCLI.testAdminInstrumentation is flakey (rkanter)
OOZIE-2377 Hive2 Action should not propagate oozie.hive2.* properties to Beeline (rkanter)
OOZIE-2376 Default action configs not honored if no <configuration> section in workflow (rkanter)
OOZIE-2365 oozie fail to start when smtp password not set (rohini)
OOZIE-2360 Spark Action fails due to missing mesos jar (rkanter)
OOZIE-2345 Parallel job submission for forked actions (puru)
OOZIE-2358 Coord rerun cleanup should reuse hcat connections (rohini)
OOZIE-2356 Add a way to enable/disable credentials in a workflow (rkanter)
OOZIE-2355 Hive2 Action doesn't pass along oozie configs to jobconf (rkanter)
OOZIE-2318 Provide better solution for specifying SSL truststore to Oozie Client (rkanter)
OOZIE-2344 Enabling 'oozie.action.jobinfo.enable' doesn't inject the job information into the map/reduce job's configuration. (akshayrai09 via rkanter)
OOZIE-2350 Package changes for release (shwethags)
OOZIE-2347 Remove unnecessary new Configuration()/new jobConf() calls from oozie (puru)
OOZIE-2348 Recovery service keeps on recovering coord action of suspended jobs (puru)
OOZIE-2277 Honor oozie.action.sharelib.for.spark in Spark jobs (rkanter)
OOZIE-2322 Oozie Web UI doesn't work with Kerberos in Internet Explorer 10 or 11 and curl (rkanter)
OOZIE-2343 Shell Action should take Oozie Action config and setup HADOOP_CONF_DIR (rkanter)
OOZIE-2245 Service to periodically check database schema (rkanter)
OOZIE-2332 Add ability to provide Hive and Hive 2 Action queries inline in workflows (prateekrungta via rkanter)
OOZIE-2329 Make handling yarn restarts configurable (puru)
OOZIE-2228 Statustransit service doesn't pick bundle with suspend status (puru)
OOZIE-2325 Shell action fails if user overrides oozie.launcher.mapreduce.map.env (kailongs via puru)
OOZIE-2324 A syntax error in the kill node causes the workflow to get stuck and other problems (rkanter)
OOZIE-2309 Enable the coord:dateOffset() function in /coordinator-app/datasets/dataset/@initial-instance (kailongs via rohini)
OOZIE-2305 Compile Oozie with Hive-1.2.0 (raviprak via shwethags)
OOZIE-2320 TestZKXLogStreamingService.testStreamingWithMultipleOozieServers_coordActionList is failing (rkanter)
OOZIE-2293 Oozie 4.0.1 build failed while building Catalog (raviprak via shwethags)
OOZIE-2308 Add support for bundle:conf() function (kailongs via rohini)
OOZIE-2315 TestOozieCLI.testshareLibUpdate_withSecurity fails with Hadoop 2 (rkanter)
OOZIE-2291 Hive2 workflow.xml.security should have "cred" in action tag instead of "hive2" tag (bzhang via rkanter)
OOZIE-2289 hive-jdbc dependency in core/pom.xml should be compile (bzhang)
OOZIE-2300 TestAuthFilterAuthOozieClient.testClientAuthTokenCache fails with Hadoop 2.7.0 and later (rkanter)
OOZIE-1837 LauncherMainHadoopUtils sensitive to clock skew (rkanter)
OOZIE-2187 Add a way to specify a default JT/RM and NN (rkanter)
OOZIE-2272 Use Hadoop's CredentialProvider for passwords in oozie-site (rkanter)
OOZIE-2287 Add support for deleting hcat partitions in fs action delete (kailongs via rohini)
OOZIE-2285 Change in concurrency should trigger coord action ready command (kailongs via rohini)
OOZIE-2284 HBaseCredentials should only add hbase-default.xml and hbase-site.xml to actionConf (rohini)
OOZIE-2286 Update Log4j and Log4j-extras to latest 1.2.x release (rkanter)
OOZIE-2250 Show log for WAITING and TIMEDOUT coord actions (kailongs via rohini)
OOZIE-2262 Fix log streaming from other server with start/end filter (kailongs via rohini)
OOZIE-2159 'oozie validate' command should be moved server-side (seoeun25 via rkanter)
OOZIE-2271 Upgrade Tomcat to 6.0.44 (rkanter)
OOZIE-2266 Fix 'total' actions returned in coordinator job info (sai-krish via rkanter)
OOZIE-2264 Fix coord:offset(n,"DAY") to resolve correct data set (kailongs via puru)
OOZIE-2178 fix javadoc to compile on JDK8 (rkanter)
OOZIE-2268 Update ActiveMQ version for security and other fixes (rkanter)
OOZIE-2215 Support glob in FS EL function (ryota)
OOZIE-2270 Audit log doesn't get loaded when "audit log" tab is clicked for coord job (puru)
OOZIE-2257 BundleStatusTransitXCommand doesn't update last modified time (puru)
OOZIE-2260 Only set "java.io.tmpdir" to "./tmp" for the AM (ryota)

Patches in hdp 2.3, but not in apache oozie-4.2.0
OOZIE-2291 Hive2 workflow.xml.security should have "cred" in action tag instead of "hive2" tag
OOZIE-2289 hive-jdbc dependency in core/pom.xml should be compile
OOZIE-2290 Oozie db version update should happen after all DDL tweak
